exports={};
(function(){function e(){}exports.inherits=function(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})};var f=Array.isArray;exports.EventEmitter=e;e.prototype.setMaxListeners=function(a){this._events||(this._events={});this._maxListeners=a};e.prototype.emit=function(){var a=arguments[0];if("error"===a&&(!this._events||!this._events.error||f(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");
}if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if("function"==typeof b){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:for(var a=arguments.length,d=Array(a-1),c=1;c<a;c++)d[c-1]=arguments[c];b.apply(this,d)}return!0}if(f(b)){a=arguments.length;d=Array(a-1);for(c=1;c<a;c++)d[c-1]=arguments[c];b=b.slice();c=0;for(a=b.length;c<a;c++)b[c].apply(this,d);return!0}return!1};e.prototype.addListener=
function(a,b){if("function"!==typeof b)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",a,b);this._events[a]?f(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b;if(f(this._events[a])&&!this._events[a].warned){var d;if((d=void 0!==this._maxListeners?this._maxListeners:10)&&0<d&&this._events[a].length>d)this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[a].length),console.trace()}return this};e.prototype.on=e.prototype.addListener;e.prototype.once=function(a,b){function d(){c.removeListener(a,d);b.apply(this,arguments)}if("function"!==typeof b)throw Error(".once only takes instances of Function");var c=this;d.listener=b;c.on(a,d);return this};e.prototype.removeListener=function(a,b){if("function"!==typeof b)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var d=this._events[a];
if(f(d)){for(var c=-1,g=0,e=d.length;g<e;g++)if(d[g]===b||d[g].listener&&d[g].listener===b){c=g;break}if(0>c)return this;d.splice(c,1);0==d.length&&delete this._events[a]}else(d===b||d.listener&&d.listener===b)&&delete this._events[a];return this};e.prototype.removeAllListeners=function(a){if(0===arguments.length)return this._events={},this;a&&(this._events&&this._events[a])&&(this._events[a]=null);return this};e.prototype.listeners=function(a){this._events||(this._events={});this._events[a]||(this._events[a]=
[]);f(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]}})();neutrino={};neutrino.exports=exports;
(function(){function e(a){var b=this;neutrino.exports.EventEmitter.call(b);b.setMaxListeners(0);b.subscriptions_={};b.cookieProvider_=new f;b.on("socketReady",function(){b.isSocketReady_=!0});b.sessionId=b.cookieProvider_.getCookie("sid");b.connect_(a)}function f(){}neutrino.ViewHubClient=e;neutrino.exports.inherits(e,neutrino.exports.EventEmitter);e.prototype.isSocketReady_=!1;e.prototype.eventEmitter_=null;e.prototype.generateRequestId_=function(){return(new Date).getTime()+Math.random()};e.prototype.cookieProvider_=
null;e.prototype.subscriptions_=null;e.prototype.socket_=null;e.prototype.connect_=function(a){var b=this;microAjax(a+"/getWorker",function(a){var c=(new Function("return "+a))(),a="http://"+c.host+":"+c.port;if(!c.host||!c.port)throw Error("Neutrino has no worker nodes");b.socket_=io.connect(a);b.socket_.on("newValue",function(a,c,d,e){b.newValueHandler_(a,c,d,e)});b.socket_.on("invokeMethodResponse",function(a){b.responseHandler_(a)});b.socket_.on("subscribeResponse",function(a){b.responseHandler_(a)});
b.socket_.on("unsubscribeResponse",function(a){b.responseHandler_(a)});b.socket_.on("editResponse",function(a){b.responseHandler_(a)});b.socket_.on("getModelResponse",function(a){b.responseHandler_(a)});b.socket_.on("reconnect",function(){b.reconnectHandler_();b.emit("reconnect",c)});b.socket_.on("connect",function(){b.emit("connect",c)});b.socket_.on("disconnect",function(){b.emit("disconnect")});b.emit("socketReady")})};e.prototype.invoke=function(a,b,d){var c=this,g=c.generateRequestId_(),e=Array.prototype.slice.call(arguments,
3),f=function(){!a||!b?d&&d(Error("View name and method name must be specified")):(c.once("response"+g,function(a){c.removeAllListeners("response"+g);a.success?d&&d(null,a.result):d&&d(Error("Server declined method invocation"))}),c.socket_.emit("invokeMethodRequest",{viewName:a,methodName:b,args:e,sessionId:c.sessionId,id:g}))};if(c.isSocketReady_)f();else c.once("socketReady",f)};e.prototype.getModel=function(a,b){var d=this,c=d.generateRequestId_(),e=function(){a?(d.once("response"+c,function(a){d.removeAllListeners("response"+
c);a.success?b&&b(null,a.model):b&&b(Error("Server declined model request"))}),d.socket_.emit("getModelRequest",{viewName:a,sessionId:d.sessionId,id:c})):b&&b(Error("View name must be specified"))};if(d.isSocketReady_)e();else d.once("socketReady",e)};e.prototype.setValue=function(a,b,d,c){var e=this,f=e.generateRequestId_(),h=function(){!a||!b?c&&c(Error("View name and property name must be specified")):(e.once("response"+f,function(a){e.removeAllListeners("response"+f);a.success?c&&c(null):c&&c(Error("Server declined new value of property"))}),
e.socket_.emit("editRequest",{viewName:a,propertyName:b,newValue:d,sessionId:e.sessionId,id:f}))};if(e.isSocketReady_)h();else e.once("socketReady",h)};e.prototype.subscribe=function(a,b,d){if(!a||!b)d&&d(Error("View name and handler must be specified"));else{var c=this,e=c.generateRequestId_(),f=function(){c.once("response"+e,function(f){c.removeAllListeners("response"+e);f.success?(c.subscriptions_[a]||(c.subscriptions_[a]=[]),c.subscriptions_[a].push(b),d&&d(null)):d&&d(Error("Server declined subscription"))});
c.socket_.emit("subscribeRequest",{viewName:a,sessionId:c.sessionId,id:e})};if(c.isSocketReady_)f();else c.once("socketReady",f)}};e.prototype.unsubscribe=function(a,b,d){if(!a||!b)d&&d(Error("View name and handler must be specified"));else if(!c.subscriptions_[a]||0===c.subscriptions_[a].length)d&&d(Error("This view has no subscriptions yet"));else{var c=this,e=c.generateRequestId_(),f=function(){c.once("response"+e,function(f){c.removeAllListeners("response"+e);var i=c.subscriptions_[a].indexOf(b);
c.subscriptions_.splice(i,1);f.success?d&&d(null):d&&d(Error("Server declined unsubscribe message"))});c.socket_.emit("unsubscribeRequest",{viewName:a,sessionId:c.sessionId,id:e})};if(c.isSocketReady_)f();else c.once("socketReady",f)}};e.prototype.reconnectHandler_=function(){for(var a in this.subscriptions_)if(this.subscriptions_.hasOwnProperty(a)){var b=this.generateRequestId_();this.socket_.emit("subscribeRequest",{viewName:a,sessionId:this.sessionId,id:b})}};e.prototype.responseHandler_=function(a){a.requestId&&
a.sessionId&&(this.sessionId||(this.sessionId=a.sessionId,this.cookieProvider_.setCookie("sid",a.sessionId)),this.emit("response"+a.requestId,a.responseBody))};e.prototype.newValueHandler_=function(a,b,d,c){this.subscriptions_.hasOwnProperty(a)&&this.subscriptions_[a].forEach(function(a){a(b,d,c)})};f.prototype.setCookie=function(a,b,d,c,e,f){if(!a||!b)return!1;a=a+"="+encodeURIComponent(b);d&&(a+="; expires="+d.toGMTString());c&&(a+="; path="+c);e&&(a+="; domain="+e);f&&(a+="; secure");document.cookie=
a;return!0};f.prototype.getCookie=function(a){return RegExp("(?:; )?"+a+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null};f.prototype.removeCookie=function(a,b,d){this.setCookie(a,null,new Date(0),b,d);return!0}})();