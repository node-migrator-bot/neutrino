exports={};
(function(){function a(){}exports.inherits=function(a,b){a.super_=b;a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})};var g=Array.isArray;exports.EventEmitter=a;a.prototype.setMaxListeners=function(a){this._events||(this._events={});this._maxListeners=a};a.prototype.emit=function(){var a=arguments[0];if("error"===a&&(!this._events||!this._events.error||g(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");
}if(!this._events)return!1;var b=this._events[a];if(!b)return!1;if("function"==typeof b){switch(arguments.length){case 1:b.call(this);break;case 2:b.call(this,arguments[1]);break;case 3:b.call(this,arguments[1],arguments[2]);break;default:for(var a=arguments.length,d=Array(a-1),c=1;c<a;c++)d[c-1]=arguments[c];b.apply(this,d)}return!0}if(g(b)){a=arguments.length;d=Array(a-1);for(c=1;c<a;c++)d[c-1]=arguments[c];b=b.slice();c=0;for(a=b.length;c<a;c++)b[c].apply(this,d);return!0}return!1};a.prototype.addListener=
function(a,b){if("function"!==typeof b)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",a,b);this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b;if(g(this._events[a])&&!this._events[a].warned){var d;if((d=void 0!==this._maxListeners?this._maxListeners:10)&&0<d&&this._events[a].length>d)this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[a].length),console.trace()}return this};a.prototype.on=a.prototype.addListener;a.prototype.once=function(a,b){function d(){c.removeListener(a,d);b.apply(this,arguments)}if("function"!==typeof b)throw Error(".once only takes instances of Function");var c=this;d.listener=b;c.on(a,d);return this};a.prototype.removeListener=function(a,b){if("function"!==typeof b)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var d=this._events[a];
if(g(d)){for(var c=-1,e=0,f=d.length;e<f;e++)if(d[e]===b||d[e].listener&&d[e].listener===b){c=e;break}if(0>c)return this;d.splice(c,1);0==d.length&&delete this._events[a]}else(d===b||d.listener&&d.listener===b)&&delete this._events[a];return this};a.prototype.removeAllListeners=function(a){if(0===arguments.length)return this._events={},this;a&&(this._events&&this._events[a])&&(this._events[a]=null);return this};a.prototype.listeners=function(a){this._events||(this._events={});this._events[a]||(this._events[a]=
[]);g(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]}})();neutrino={};neutrino.exports=exports;
(function(){function a(b){var d=this;neutrino.exports.EventEmitter.call(d);d.setMaxListeners(0);d.masterUrl=b;d.ajaxProvider_=new neutrino.AjaxProvider;d.changeSubscriptions_={};d.cookieProvider_=new neutrino.CookieProvider;d.on(a.events.socketReady,function(){d.isSocketReady_=!0});d.sessionId=d.cookieProvider_.getCookie("sid");d.connect_()}function g(){}function i(){}neutrino.ViewHubClient=a;neutrino.exports.inherits(a,neutrino.exports.EventEmitter);a.events={newValue:"newValue",notification:"notification",
modelResponse:"modelResponse",invokeResponse:"invokeResponse",editResponse:"editResponse",subscribeResponse:"subscribeResponse",unsubscribeResponse:"unsubscribeResponse",socketReady:"socketReady",connect:"connect",disconnect:"disconnect"};a.requests={modelRequest:"modelRequest",invokeRequest:"invokeRequest",editRequest:"editRequest",subscribeRequest:"subscribeRequest",unsubscribeRequest:"unsubscribeRequest"};a.prototype.ajaxProvider_=null;a.prototype.masterUrl="";a.prototype.isSocketReady_=!1;a.prototype.generateRequestId_=
function(){return(new Date).getTime()+Math.random()};a.prototype.cookieProvider_=null;a.prototype.changeSubscriptions_=null;a.prototype.socketNamespace_=null;a.prototype.connect_=function(){var b=this;b.ajaxProvider_.requestJson(b.masterUrl+"/getWorker",function(d,c){d||!c||!c.host||!c.port?setTimeout(function(){b.connect_()},5E3):(b.socketNamespace_=io.connect((c.secure?"https":"http")+"://"+c.host+":"+c.port,{resource:"viewhub",reconnect:!1}),b.socketNamespace_.on(a.events.newValue,function(a,c,
d,g){b.newValueHandler_(a,c,d,g)}),b.socketNamespace_.on(a.events.notification,function(c,d){b.emit(a.events.notification,c,d)}),b.socketNamespace_.on(a.events.invokeResponse,function(a){b.responseHandler_(a)}),b.socketNamespace_.on(a.events.subscribeResponse,function(a){b.responseHandler_(a)}),b.socketNamespace_.on(a.events.unsubscribeResponse,function(a){b.responseHandler_(a)}),b.socketNamespace_.on(a.events.editResponse,function(a){b.responseHandler_(a)}),b.socketNamespace_.on(a.events.modelResponse,
function(a){b.responseHandler_(a)}),b.socketNamespace_.on("connect",function(){b.connectHandler_();b.emit(a.events.connect,c)}),b.socketNamespace_.on("disconnect",function(){b.disconnectHandler_();b.emit(a.events.disconnect)}),b.emit(a.events.socketReady))})};a.prototype.invoke=function(b,d,c,e){var f=this,h=f.generateRequestId_(),g=Array.prototype.slice.call(arguments,3),j=function(){!b||!d?c&&c(Error("View name and method name must be specified")):(f.once("response"+h,function(a){f.removeAllListeners("response"+
h);a.success?c&&c(null,a.result):c&&c(Error("Server declined method invocation"))}),f.socketNamespace_.emit(a.requests.invokeRequest,{viewName:b,methodName:d,args:g,sessionId:f.sessionId,id:h}))};if(f.isSocketReady_)j();else f.once(a.events.socketReady,j)};a.prototype.getModel=function(b,d){var c=this,e=c.generateRequestId_(),f=function(){b?(c.once("response"+e,function(a){c.removeAllListeners("response"+e);a.success?d&&d(null,a.model):d&&d(Error("Server declined model request"))}),c.socketNamespace_.emit(a.requests.modelRequest,
{viewName:b,sessionId:c.sessionId,id:e})):d&&d(Error("View name must be specified"))};if(c.isSocketReady_)f();else c.once(a.events.socketReady,f)};a.prototype.setValue=function(b,d,c,e){var f=this,h=f.generateRequestId_(),g=function(){!b||!d?e&&e(Error("View name and property name must be specified")):(f.once("response"+h,function(a){f.removeAllListeners("response"+h);a.success?e&&e(null):e&&e(Error("Server declined new value of property"))}),f.socketNamespace_.emit(a.requests.editRequest,{viewName:b,
propertyName:d,newValue:c,sessionId:f.sessionId,id:h}))};if(f.isSocketReady_)g();else f.once(a.events.socketReady,g)};a.prototype.subscribe=function(b,d,c){if(!b||!d)c&&c(Error("View name and handler must be specified"));else{var e=this,f=e.generateRequestId_(),g=function(){e.once("response"+f,function(a){e.removeAllListeners("response"+f);a.success?(e.changeSubscriptions_[b]||(e.changeSubscriptions_[b]=[]),e.changeSubscriptions_[b].push(d),c&&c(null)):c&&c(Error("Server declined subscription"))});
e.socketNamespace_.emit(a.requests.subscribeRequest,{viewName:b,sessionId:e.sessionId,id:f})};if(e.isSocketReady_)g();else e.once(a.events.socketReady,g)}};a.prototype.unsubscribe=function(b,d,c){var e=this;if(!b||!d)c&&c(Error("View name and handler must be specified"));else if(!e.changeSubscriptions_[b]||0===e.changeSubscriptions_[b].length)c&&c(Error("This view has no subscriptions yet"));else{var f=e.generateRequestId_(),g=function(){e.once("response"+f,function(a){e.removeAllListeners("response"+
f);var g=e.changeSubscriptions_[b].indexOf(d);e.changeSubscriptions_.splice(g,1);a.success?c&&c(null):c&&c(Error("Server declined unsubscribe message"))});e.socketNamespace_.emit(a.requests.unsubscribeRequest,{viewName:b,sessionId:e.sessionId,id:f})};if(e.isSocketReady_)g();else e.once(a.events.socketReady,g)}};a.prototype.disconnectHandler_=function(){this.isSocketReady_=!1;this.socketNamespace_.removeAllListeners();this.connect_()};a.prototype.connectHandler_=function(){for(var b in this.changeSubscriptions_)if(this.changeSubscriptions_.hasOwnProperty(b)){var d=
this.generateRequestId_();this.socketNamespace_.emit(a.requests.subscribeRequest,{viewName:b,sessionId:this.sessionId,id:d})}};a.prototype.responseHandler_=function(a){a.requestId&&a.sessionId&&(this.sessionId=a.sessionId,this.cookieProvider_.setCookie("sid",a.sessionId),this.emit("response"+a.requestId,a.responseBody))};a.prototype.newValueHandler_=function(a,d,c,e){this.changeSubscriptions_.hasOwnProperty(a)&&this.changeSubscriptions_[a].forEach(function(a){a(d,c,e)})};neutrino.CookieProvider=g;
g.prototype.setCookie=function(a,d,c,e,f,g){if(!a||!d)return!1;a=a+"="+encodeURIComponent(d);c&&(a+="; expires="+c.toGMTString());e&&(a+="; path="+e);f&&(a+="; domain="+f);g&&(a+="; secure");document.cookie=a;return!0};g.prototype.getCookie=function(a){return RegExp("(?:; )?"+a+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):null};g.prototype.removeCookie=function(a,d,c){this.setCookie(a,null,new Date(0),d,c);return!0};neutrino.AjaxProvider=i;i.prototype.createRequest_=function(){if("undefined"!==
typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){return new ActiveXObject("Microsoft.XMLHTTP")}throw Error("AJAX is not supported");};i.prototype.request=function(a,d){var c=this.createRequest_();c.open("GET",a,!0);c.send(null);if(d){var e=function(){4!=c.readyState?setTimeout(e,10):200==c.status?d(null,c.responseText):d(Error(c.status),null)};setTimeout(e,10)}};i.prototype.requestJson=function(a,d){this.request(a,
function(a,b){try{var f=(new Function("return "+b))();d(null,f)}catch(g){d(g,null)}})}})();