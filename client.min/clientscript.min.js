exports={};
(function(){function e(){}exports.inherits=function(a,c){a.super_=c;a.prototype=Object.create(c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})};var f=Array.isArray;exports.EventEmitter=e;e.prototype.setMaxListeners=function(a){this._events||(this._events={});this._maxListeners=a};e.prototype.emit=function(){var a=arguments[0];if("error"===a&&(!this._events||!this._events.error||f(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");
}if(!this._events)return!1;var c=this._events[a];if(!c)return!1;if("function"==typeof c){switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(var a=arguments.length,d=Array(a-1),b=1;b<a;b++)d[b-1]=arguments[b];c.apply(this,d)}return!0}if(f(c)){a=arguments.length;d=Array(a-1);for(b=1;b<a;b++)d[b-1]=arguments[b];c=c.slice();b=0;for(a=c.length;b<a;b++)c[b].apply(this,d);return!0}return!1};e.prototype.addListener=
function(a,c){if("function"!==typeof c)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",a,c);this._events[a]?f(this._events[a])?this._events[a].push(c):this._events[a]=[this._events[a],c]:this._events[a]=c;if(f(this._events[a])&&!this._events[a].warned){var d;if((d=void 0!==this._maxListeners?this._maxListeners:10)&&0<d&&this._events[a].length>d)this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[a].length),console.trace()}return this};e.prototype.on=e.prototype.addListener;e.prototype.once=function(a,c){function d(){b.removeListener(a,d);c.apply(this,arguments)}if("function"!==typeof c)throw Error(".once only takes instances of Function");var b=this;d.listener=c;b.on(a,d);return this};e.prototype.removeListener=function(a,c){if("function"!==typeof c)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[a])return this;var d=this._events[a];
if(f(d)){for(var b=-1,g=0,e=d.length;g<e;g++)if(d[g]===c||d[g].listener&&d[g].listener===c){b=g;break}if(0>b)return this;d.splice(b,1);0==d.length&&delete this._events[a]}else(d===c||d.listener&&d.listener===c)&&delete this._events[a];return this};e.prototype.removeAllListeners=function(a){if(0===arguments.length)return this._events={},this;a&&(this._events&&this._events[a])&&(this._events[a]=null);return this};e.prototype.listeners=function(a){this._events||(this._events={});this._events[a]||(this._events[a]=
[]);f(this._events[a])||(this._events[a]=[this._events[a]]);return this._events[a]}})();neutrino={};neutrino.exports=exports;
(function(){function e(a){var c=this;neutrino.exports.EventEmitter.call(c);c.setMaxListeners(0);c.masterUrl=a;c.subscriptions_={};c.cookieProvider_=new f;c.on("socketReady",function(){c.isSocketReady_=!0});c.sessionId=c.cookieProvider_.getCookie("sid");c.connect_(a)}function f(){}neutrino.ViewHubClient=e;neutrino.exports.inherits(e,neutrino.exports.EventEmitter);e.prototype.masterUrl="";e.prototype.isSocketReady_=!1;e.prototype.eventEmitter_=null;e.prototype.generateRequestId_=function(){return(new Date).getTime()+
Math.random()};e.prototype.cookieProvider_=null;e.prototype.subscriptions_=null;e.prototype.socketNamespace_=null;e.prototype.connect_=function(){var a=this;microAjax(a.masterUrl+"/getWorker",function(c){var d=(new Function("return "+c))();!d||!d.host||!d.port?setTimeout(function(){a.connect_()},5E3):(a.socketNamespace_=io.connect("http://"+d.host+":"+d.port,{reconnect:!1}),a.socketNamespace_.on("newValue",function(b,c,d,e){a.newValueHandler_(b,c,d,e)}),a.socketNamespace_.on("invokeMethodResponse",
function(b){a.responseHandler_(b)}),a.socketNamespace_.on("subscribeResponse",function(b){a.responseHandler_(b)}),a.socketNamespace_.on("unsubscribeResponse",function(b){a.responseHandler_(b)}),a.socketNamespace_.on("editResponse",function(b){a.responseHandler_(b)}),a.socketNamespace_.on("getModelResponse",function(b){a.responseHandler_(b)}),a.socketNamespace_.on("connect",function(){a.connectHandler_();a.emit("connect",d)}),a.socketNamespace_.on("disconnect",function(){a.disconnectHandler_();a.emit("disconnect")}),
a.emit("socketReady"))})};e.prototype.invoke=function(a,c,d){var b=this,e=b.generateRequestId_(),h=Array.prototype.slice.call(arguments,3),f=function(){!a||!c?d&&d(Error("View name and method name must be specified")):(b.once("response"+e,function(a){b.removeAllListeners("response"+e);a.success?d&&d(null,a.result):d&&d(Error("Server declined method invocation"))}),b.socketNamespace_.emit("invokeMethodRequest",{viewName:a,methodName:c,args:h,sessionId:b.sessionId,id:e}))};if(b.isSocketReady_)f();else b.once("socketReady",
f)};e.prototype.getModel=function(a,c){var d=this,b=d.generateRequestId_(),e=function(){a?(d.once("response"+b,function(a){d.removeAllListeners("response"+b);a.success?c&&c(null,a.model):c&&c(Error("Server declined model request"))}),d.socketNamespace_.emit("getModelRequest",{viewName:a,sessionId:d.sessionId,id:b})):c&&c(Error("View name must be specified"))};if(d.isSocketReady_)e();else d.once("socketReady",e)};e.prototype.setValue=function(a,c,d,b){var e=this,f=e.generateRequestId_(),i=function(){!a||
!c?b&&b(Error("View name and property name must be specified")):(e.once("response"+f,function(a){e.removeAllListeners("response"+f);a.success?b&&b(null):b&&b(Error("Server declined new value of property"))}),e.socketNamespace_.emit("editRequest",{viewName:a,propertyName:c,newValue:d,sessionId:e.sessionId,id:f}))};if(e.isSocketReady_)i();else e.once("socketReady",i)};e.prototype.subscribe=function(a,c,d){if(!a||!c)d&&d(Error("View name and handler must be specified"));else{var b=this,e=b.generateRequestId_(),
f=function(){b.once("response"+e,function(f){b.removeAllListeners("response"+e);f.success?(b.subscriptions_[a]||(b.subscriptions_[a]=[]),b.subscriptions_[a].push(c),d&&d(null)):d&&d(Error("Server declined subscription"))});b.socketNamespace_.emit("subscribeRequest",{viewName:a,sessionId:b.sessionId,id:e})};if(b.isSocketReady_)f();else b.once("socketReady",f)}};e.prototype.unsubscribe=function(a,c,d){if(!a||!c)d&&d(Error("View name and handler must be specified"));else if(!b.subscriptions_[a]||0===
b.subscriptions_[a].length)d&&d(Error("This view has no subscriptions yet"));else{var b=this,e=b.generateRequestId_(),f=function(){b.once("response"+e,function(f){b.removeAllListeners("response"+e);var h=b.subscriptions_[a].indexOf(c);b.subscriptions_.splice(h,1);f.success?d&&d(null):d&&d(Error("Server declined unsubscribe message"))});b.socketNamespace_.emit("unsubscribeRequest",{viewName:a,sessionId:b.sessionId,id:e})};if(b.isSocketReady_)f();else b.once("socketReady",f)}};e.prototype.disconnectHandler_=
function(){this.isSocketReady_=!1;this.socketNamespace_.removeAllListeners();this.connect_()};e.prototype.connectHandler_=function(){for(var a in this.subscriptions_)if(this.subscriptions_.hasOwnProperty(a)){var c=this.generateRequestId_();this.socketNamespace_.emit("subscribeRequest",{viewName:a,sessionId:this.sessionId,id:c})}};e.prototype.responseHandler_=function(a){a.requestId&&a.sessionId&&(this.sessionId||(this.sessionId=a.sessionId,this.cookieProvider_.setCookie("sid",a.sessionId)),this.emit("response"+
a.requestId,a.responseBody))};e.prototype.newValueHandler_=function(a,c,d,b){this.subscriptions_.hasOwnProperty(a)&&this.subscriptions_[a].forEach(function(a){a(c,d,b)})};f.prototype.setCookie=function(a,c,d,b,e,f){if(!a||!c)return!1;a=a+"="+encodeURIComponent(c);d&&(a+="; expires="+d.toGMTString());b&&(a+="; path="+b);e&&(a+="; domain="+e);f&&(a+="; secure");document.cookie=a;return!0};f.prototype.getCookie=function(a){return RegExp("(?:; )?"+a+"=([^;]*);?").test(document.cookie)?decodeURIComponent(RegExp.$1):
null};f.prototype.removeCookie=function(a,c,d){this.setCookie(a,null,new Date(0),c,d);return!0}})();