exports={};
(function(){function d(){}exports.inherits=function(b,a){b.super_=a;b.prototype=Object.create(a.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}})};var f=Array.isArray;exports.EventEmitter=d;d.prototype.setMaxListeners=function(b){this._events||(this._events={});this._maxListeners=b};d.prototype.emit=function(){var b=arguments[0];if("error"===b&&(!this._events||!this._events.error||f(this._events.error)&&!this._events.error.length)){if(arguments[1]instanceof Error)throw arguments[1];throw Error("Uncaught, unspecified 'error' event.");
}if(!this._events)return!1;var a=this._events[b];if(!a)return!1;if("function"==typeof a){switch(arguments.length){case 1:a.call(this);break;case 2:a.call(this,arguments[1]);break;case 3:a.call(this,arguments[1],arguments[2]);break;default:for(var b=arguments.length,e=Array(b-1),c=1;c<b;c++)e[c-1]=arguments[c];a.apply(this,e)}return!0}if(f(a)){b=arguments.length;e=Array(b-1);for(c=1;c<b;c++)e[c-1]=arguments[c];a=a.slice();c=0;for(b=a.length;c<b;c++)a[c].apply(this,e);return!0}return!1};d.prototype.addListener=
function(b,a){if("function"!==typeof a)throw Error("addListener only takes instances of Function");this._events||(this._events={});this.emit("newListener",b,a);this._events[b]?f(this._events[b])?this._events[b].push(a):this._events[b]=[this._events[b],a]:this._events[b]=a;if(f(this._events[b])&&!this._events[b].warned){var e;if((e=void 0!==this._maxListeners?this._maxListeners:10)&&0<e&&this._events[b].length>e)this._events[b].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",
this._events[b].length),console.trace()}return this};d.prototype.on=d.prototype.addListener;d.prototype.once=function(b,a){function e(){c.removeListener(b,e);a.apply(this,arguments)}if("function"!==typeof a)throw Error(".once only takes instances of Function");var c=this;e.listener=a;c.on(b,e);return this};d.prototype.removeListener=function(b,a){if("function"!==typeof a)throw Error("removeListener only takes instances of Function");if(!this._events||!this._events[b])return this;var e=this._events[b];
if(f(e)){for(var c=-1,i=0,g=e.length;i<g;i++)if(e[i]===a||e[i].listener&&e[i].listener===a){c=i;break}if(0>c)return this;e.splice(c,1);0==e.length&&delete this._events[b]}else(e===a||e.listener&&e.listener===a)&&delete this._events[b];return this};d.prototype.removeAllListeners=function(b){if(0===arguments.length)return this._events={},this;b&&(this._events&&this._events[b])&&(this._events[b]=null);return this};d.prototype.listeners=function(b){this._events||(this._events={});this._events[b]||(this._events[b]=
[]);f(this._events[b])||(this._events[b]=[this._events[b]]);return this._events[b]}})();neutrino={};neutrino.exports=exports;
(function(){function d(a){var e=this;neutrino.exports.EventEmitter.call(e);e.setMaxListeners(0);e.masterUrl=a;e.ajax_=new b;e.subscriptions_={};e.cookieProvider_=new f;e.on("socketReady",function(){e.isSocketReady_=!0});e.sessionId=e.cookieProvider_.getCookie("sid");e.connect_(a)}function f(){}function b(){}neutrino.ViewHubClient=d;neutrino.exports.inherits(d,neutrino.exports.EventEmitter);d.prototype.ajax_=null;d.prototype.masterUrl="";d.prototype.isSocketReady_=!1;d.prototype.eventEmitter_=null;
d.prototype.generateRequestId_=function(){return(new Date).getTime()+Math.random()};d.prototype.cookieProvider_=null;d.prototype.subscriptions_=null;d.prototype.socketNamespace_=null;d.prototype.connect_=function(){var a=this;a.ajax_.requestJson(a.masterUrl+"/getWorker",function(e,c){e||!c||!c.host||!c.port?setTimeout(function(){a.connect_()},5E3):(a.socketNamespace_=io.connect("http://"+c.host+":"+c.port,{resource:"viewhub",reconnect:!1}),a.socketNamespace_.on("newValue",function(c,e,b,d){a.newValueHandler_(c,
e,b,d)}),a.socketNamespace_.on("invokeMethodResponse",function(c){a.responseHandler_(c)}),a.socketNamespace_.on("subscribeResponse",function(c){a.responseHandler_(c)}),a.socketNamespace_.on("unsubscribeResponse",function(c){a.responseHandler_(c)}),a.socketNamespace_.on("editResponse",function(c){a.responseHandler_(c)}),a.socketNamespace_.on("getModelResponse",function(c){a.responseHandler_(c)}),a.socketNamespace_.on("connect",function(){a.connectHandler_();a.emit("connect",c)}),a.socketNamespace_.on("disconnect",
function(){a.disconnectHandler_();a.emit("disconnect")}),a.emit("socketReady"))})};d.prototype.invoke=function(a,e,c,b){var g=this,d=g.generateRequestId_(),f=Array.prototype.slice.call(arguments,3),j=function(){!a||!e?c&&c(Error("View name and method name must be specified")):(g.once("response"+d,function(a){g.removeAllListeners("response"+d);a.success?c&&c(null,a.result):c&&c(Error("Server declined method invocation"))}),g.socketNamespace_.emit("invokeMethodRequest",{viewName:a,methodName:e,args:f,
sessionId:g.sessionId,id:d}))};if(g.isSocketReady_)j();else g.once("socketReady",j)};d.prototype.getModel=function(a,e){var c=this,b=c.generateRequestId_(),d=function(){a?(c.once("response"+b,function(a){c.removeAllListeners("response"+b);a.success?e&&e(null,a.model):e&&e(Error("Server declined model request"))}),c.socketNamespace_.emit("getModelRequest",{viewName:a,sessionId:c.sessionId,id:b})):e&&e(Error("View name must be specified"))};if(c.isSocketReady_)d();else c.once("socketReady",d)};d.prototype.setValue=
function(a,e,c,b){var d=this,f=d.generateRequestId_(),k=function(){!a||!e?b&&b(Error("View name and property name must be specified")):(d.once("response"+f,function(a){d.removeAllListeners("response"+f);a.success?b&&b(null):b&&b(Error("Server declined new value of property"))}),d.socketNamespace_.emit("editRequest",{viewName:a,propertyName:e,newValue:c,sessionId:d.sessionId,id:f}))};if(d.isSocketReady_)k();else d.once("socketReady",k)};d.prototype.subscribe=function(a,e,c){if(!a||!e)c&&c(Error("View name and handler must be specified"));
else{var b=this,d=b.generateRequestId_(),f=function(){b.once("response"+d,function(f){b.removeAllListeners("response"+d);f.success?(b.subscriptions_[a]||(b.subscriptions_[a]=[]),b.subscriptions_[a].push(e),c&&c(null)):c&&c(Error("Server declined subscription"))});b.socketNamespace_.emit("subscribeRequest",{viewName:a,sessionId:b.sessionId,id:d})};if(b.isSocketReady_)f();else b.once("socketReady",f)}};d.prototype.unsubscribe=function(a,b,c){if(!a||!b)c&&c(Error("View name and handler must be specified"));
else if(!d.subscriptions_[a]||0===d.subscriptions_[a].length)c&&c(Error("This view has no subscriptions yet"));else{var d=this,f=d.generateRequestId_(),h=function(){d.once("response"+f,function(h){d.removeAllListeners("response"+f);var j=d.subscriptions_[a].indexOf(b);d.subscriptions_.splice(j,1);h.success?c&&c(null):c&&c(Error("Server declined unsubscribe message"))});d.socketNamespace_.emit("unsubscribeRequest",{viewName:a,sessionId:d.sessionId,id:f})};if(d.isSocketReady_)h();else d.once("socketReady",
h)}};d.prototype.disconnectHandler_=function(){this.isSocketReady_=!1;this.socketNamespace_.removeAllListeners();this.connect_()};d.prototype.connectHandler_=function(){for(var a in this.subscriptions_)if(this.subscriptions_.hasOwnProperty(a)){var b=this.generateRequestId_();this.socketNamespace_.emit("subscribeRequest",{viewName:a,sessionId:this.sessionId,id:b})}};d.prototype.responseHandler_=function(a){a.requestId&&a.sessionId&&(this.sessionId||(this.sessionId=a.sessionId,this.cookieProvider_.setCookie("sid",
a.sessionId)),this.emit("response"+a.requestId,a.responseBody))};d.prototype.newValueHandler_=function(a,b,c,d){this.subscriptions_.hasOwnProperty(a)&&this.subscriptions_[a].forEach(function(a){a(b,c,d)})};f.prototype.setCookie=function(a,b,c,d,f,h){if(!a||!b)return!1;a=a+"="+encodeURIComponent(b);c&&(a+="; expires="+c.toGMTString());d&&(a+="; path="+d);f&&(a+="; domain="+f);h&&(a+="; secure");document.cookie=a;return!0};f.prototype.getCookie=function(a){return RegExp("(?:; )?"+a+"=([^;]*);?").test(document.cookie)?
decodeURIComponent(RegExp.$1):null};f.prototype.removeCookie=function(a,b,c){this.setCookie(a,null,new Date(0),b,c);return!0};b.prototype.createRequest_=function(){if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(a){return new ActiveXObject("Microsoft.XMLHTTP")}throw Error("AJAX is not supported");};b.prototype.request=function(a,b){var c=this.createRequest_();c.open("GET",a,!0);c.send(null);
if(b){var d=function(){4!=c.readyState?setTimeout(d,10):200==c.status?b(null,c.responseText):b(Error(c.status),null)};setTimeout(d,10)}};b.prototype.requestJson=function(a,b){this.request(a,function(a,d){try{var f=(new Function("return "+d))();b(null,f)}catch(h){b(h,null)}})}})();